<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
        <link type="text/css" rel="stylesheet" href="js/optional/css/timecontrol.css">
		<link type="text/css" rel="stylesheet" href="css/web2cal.css">
    <link type="text/css" rel="stylesheet" href="css/web2cal-responsive.css">

		
        
        <link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/themes/smoothness/jquery-ui.css" />
        <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/jquery-ui.min.js"></script>

        <script src="js/web2cal.support.js">  </script>
        <script src="js/web2cal.templates.js">  </script>

        <script src="js/web2cal.dummydata.js">  </script>
        <script src="js/optional/timecontrol.js">  </script>

        <title>Web2Cal | Health Club Demo</title>
	</head>
	<body> 
		<div class="sample-desc" >Describes using the calendar in a healthclub</div>
		<!-- Container holds the calendar. -->
		<div id="calendarContainer" class="web2calvista">
		</div>

<!-- Calendar Preview Template -->
<div id="calendarEventPreview" class="calendarTemplate" style="width:330px;position:absolute; display:none; border: 1px solid #5A595A;">
    <div class="aPointer p-left">
        &nbsp;
    </div>
    <div class="header" style="text-align: center;">
        <strong><span style="font-size: 12pt;">${eventName}</span></strong>
    </div> 
    <table border="0" width="100%">
        <tbody>
            <tr>
                <td valign="top">
                    <span class="labelXSmall"><strong>Start</strong>: </span>
                    <span class="startTime">${formattedStartTime}</span>
                    <br/>
                    <span class="labelXSmall"><strong>End</strong>: </span>
                    <span class="startTime">${formattedEndTime}</span>
                </td>
                <td valign="top">
                    <span class="labelXSmall"><strong>Location</strong>: </span>
                    <span class="startTime">${location}</span>
                    <br/>
                    <span class="labelXSmall">Conducted By: </span>
                    <span class="startTime">${instructor}</span>
                </td>
            </tr>
            <tr>
                <td valign="top">
                    <span class="labelXSmall"><strong>Facility</strong>: </span>
                    <span class="startTime">${facility}</span>
                    <br/>
                    <span class="labelXSmall"><strong>Event </strong><strong>Type</strong>: </span>
                    <span class="startTime">${eventType}</span>
                </td>
                <td valign="top">
                    <span class="labelXSmall"><strong>Capacity</strong>: </span>
                    <span class="startTime">${capacity}</span>
                    <br/>
                    <span class="labelXSmall"><strong>Lead Days to Cancel</strong>: </span>
                    <span class="startTime">${leadDays}</span>
                </td>
            </tr>
            <tr>
                <td style="text-align: left;" colspan="2">
                    <span class="callabel labelXSmall"><strong>Description</strong>: </span>
                    <div class="EventDescription">
                        ${eventDesc}
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <ul class="actions">
        <li>
            <a onclick="alert('Check editEvent.html to know more about editing events'); return false;" href="#">Edit Event</a>
        </li>
        <li>
            <a onclick="alert('To be implemented!'); return false;" href="#">Delete Event</a>
        </li>
        <li>
        </li>
    </ul>
</div>
<!-- New Event Template -->
<div id="calendarNewEvent" class="calendarTemplate" style="width: 370px;position:absolute; display:none; border: 1px solid #5A595A;">
    <div class="aPointer p-left " style="display: block; z-index: 2; "></div>
    <div class="header" style="text-align: center;">
        <span style="font-size: 12px;font-weight:bold;">Create New Event</span>
    </div>
    <div style="padding: 1px; padding-bottom: 20px; overflow: auto;">
        <table border="0" cellpadding="0" width="100%">  
            <tbody> 
				<tr> 
					  <td valign="top" width="50%"> 
							<div class="label">
								Select Product
							</div>
					 
							 <select name="produtList" id="produtList" onchange="loadOtherDetails(this)">
							 	<option value=""> Select </option>
							 	<option value="obj1">1/2 Hour Massage </option>
								<option value="obj2">Aqua Workout</option>
								<option value="obj3">Cardio Cross Training</option>
							 </select>
							 
							 <div id="newEventDescDiv"> </div>
				  		</td> 
						<td class="rowsNoLine" valign='top'>
							<div id="productInfo" style="display:none;">
				  			<span class="labelBlock" id="newMembershipRequiredLabelSpan">Membership Required: </span> 
							<span id="newMembershipRequiredSpan">&nbsp;</span>   
				  		 	<br/>
				  			<span class="labelBlock" id="newAgeLimitLabelSpan">Age Limit</span>&nbsp;
							<span id="newAgeLimitSpan">&nbsp;</span>  
							<br/>
							<span class="labelBlock" id="leadDaysToCancelSpan">Lead Days To Cancel : </span>&nbsp;
							<span id="newLeadDaysToCancelSpan">&nbsp;</span> 
							<br/>
							<span class="labelBlock" > Max Wait List </span>
							<span id="newWaitSizeLimit">&nbsp;</span>  
							</div>
				  		</td>
					</tr> 
					<tr>
						<td colspan="2">
							<hr/>
						</td>
					</tr>
					<tr height="40px;"> 
					  <td>
					    <div class="labelBlock"> Facility</div>
					      <select id="newGTFacility" class="inputboxblue" style="width:10em;">
					      	<option value="930">Offsite</option>
							<option value="172">Boxing Studio</option>
							<option value="1581">Squash Court</option>
							<option value="1555">Spin Studio</option>
							<option value="1619">Studio</option>
							<option value="795">Mind and Body Studio - Pilates</option>
							<option value="794" selected="selected">Mind & Body</option>
							<option value="775">Massage Room</option>
							<option value="444">General Fitness Area</option>
					      </select>
					  </td>
					  
					  <td>
					   <div class="labelBlock"> Trainers</div>
						<select class="inputboxblue" style="width:10em;">
							<option value="1">Trainer 1</option>
							<option value="2">Trainer 2</option>
							<option value="3">Trainer 3</option>
							<option value="4">Trainer 4</option>
							<option value="5">Trainer 5</option>
							<option value="6">Trainer 6</option> 
						</select>
					  </td>
					</tr>

					<tr>
					  <td>
					     <div class="labelBlock">From Date</div>
					     <input type="text" class="inputboxblue" style="width:8em;" id="startDate">
					  </td>

					  <td>
					     <div class="labelBlock">To Date</div>
					     <input type="text" class="inputboxblue"   style="width:8em;" id="endDate">
					  </td>
					</tr>

					<tr>
					  <td>
					    <div class="labelBlock"> Start Time</div>

					     <input type="text" class="inputboxblue" style="width:8em;" id="startTime">
					  </td>
					  <td>
					    <div class="labelBlock"> End Time</div>
					     <input type="text" class="inputboxblue"  style="width:8em;" id="endTime">
					  </td>
					</tr>
					
					<tr> 
					  <td>
					    <div class="labelBlock"> Capacity</div>
					     <input type="text" class="inputboxblue" style="width:3em;" id="newCapacity">
					  </td> 
					</tr>
 
					<tr>
					  <td colspan="2">
					     <div class="labelBlock">Notes</div>
					     <textarea class="inputtextarea" id="newNotes" cols="42" style="height:4em;"></textarea>
					  </td>
					</tr> 
            </tbody>
        </table>
 	            <button onclick="return createNewEvent();" class="websbutton" href="javascript:void(0)">Save Event</button>
	            <button  href="javascript:void(0)" class="websbutton"  onclick="Web2Cal.closeAddEvent();">Cancel</button>
    </div>
</div>
<!-- END CALENDAR TEMPLATES -->
<script language="javascript" type="text/javascript"> 
    /** 
     * Click of Add in add event box
     */ 
	function createNewEvent()
	{ 
        var newEventContainer = jQuery("#calendarNewEvent");
        var name = newEventContainer.find("#eventName").val();
        var productId=newEventContainer.find("#produtList").val();
		if(productId=="")
		{
			alert('Please select a product');
			newEventContainer.find("#produtList").focus();
			return false;
		}
		 
		var facilityId=newEventContainer.find("#newGTFacility").val();
		var trainerId=newEventContainer.find("#trainer").val(); 
		 
		var newNotes=newEventContainer.find("#newNotes").val(); 
        
		var startTime = newEventContainer.find("#startTime").val();
        var endTime = newEventContainer.find("#endTime").val();
        var startDate = newEventContainer.find("#startDate").val();
        var endDate = newEventContainer.find("#endDate").val(); 
        
        if (name == "") 
        {
            name = "No Title";
        } 
        var allday=false;
        name=productsArr[productId].desc;
		if(newNotes=="")
			newNotes=name;
		var start = getDateFromStrings(startDate, startTime);
        var end = getDateFromStrings(endDate, endTime);
        if (allday) 
        {
            start.setHours(0, 0, 0);
            end.setHours(0, 0, 0);
        }
        var newev = {
            name: name,
            startTime: start,
            endTime: end,
            allDay: allday,
            group: {
                groupId: 1
				, name: "Group Name"
            } 
            , eventId: Math.ceil(999 * Math.random())  
			, eventName:name
			, eventDesc: newNotes
			, eventType: "PT" 
			, facility: facilityId
			, publishStatus:"PENDING"
			, capacity: 6
			, leadDays:productsArr[productId].leadDays
			, trainers: [
					trainerId			
				]
			, registerMembers: [
						
				]
        }; 
		
        ical.addEvent(newev);
		return false;
	} 
    /**
     Onclick of Close in AddEvent Box
     */ 
	function closeAddEvent()
	{
		ical.closeAddEvent();
		return false;
	}
	
	/**
	 * Build Web2Cal 
	 */

    var WEB2CAL_LICENSE_KEY=["*****EMBED YOUR LICENSE KEY HERE****" ];
    var ical,activeEvent
            , newEventForm="defaultNewEventTemplate"
            , mobileNewEventForm="newEventFormMobile"
            , preview="previewTemplate"
            , mobilePreview="eventPreviewMobile"
            ;
    function createCalendar()
    { 
        ical = new Web2Cal('calendarContainer', {
            loadEvents: 	loadCalendarEvents,
            onUpdateEvent: 	updateEvent,
            onNewEvent: 	onNewEvent,
            views: 			"day,month,week,agenda,custom",
			controlHeight: 	"600px",
            showLeftNav: 	false,
            newEventTemplate: "calendarNewEvent",
			previewTemplate: "calendarEventPreview"
        }); 
        ical.build();
    }
    
    
    /**
     * Sets up the new event, date control / time control etc... 
     * 
     * @param {Object} newevt
     */
    function setupNewEvt(newevt)
    {
        newevt.find("#startDate").datepicker();        
        newevt.find("#endDate").datepicker();        
        newevt.find("#recurrenceRuleEndTimeDate").datepicker();
		
        var alldaybox = newevt.find("#allDayEvent").get(0);
        if (alldaybox) 
        {
            alldaybox.onclick = function()
            {
                if (this.checked) 
                {
                    newevt.find("#startTime").attr("disabled", true).val("");
                    newevt.find("#endTime").attr("disabled", true).val("");
                }
                else 
                {
                    newevt.find("#startTime").attr("disabled", false).val("12:00 am");
                    newevt.find("#endTime").attr("disabled", false).val("12:00 am");
                    
                };
             };
        }
        new Web2Cal.TimeControl(newevt.find("#startTime").get(0));
        new Web2Cal.TimeControl(newevt.find("#endTime").get(0), newevt.find("#startTime").get(0));
        
    }
    
    
    /**
     * Method invoked on creating a new event. 
     * 
     * 
     * @param {Object} obj - Object containing event time and date
     * @param {Object} newevt - New Event jQuery object
     * @param {Object} params - Parameters
     * @param {Object} groups - Groups
     * @param {Object} allday - All day indicator
     */
    function onNewEvent(obj, groups, allday)
    {
		var newevt=jQuery("#calendarNewEvent"); 
        newevt.find("#eventDesc").val("").end()
		.find("#eventName").val("").focus().end()
		.find("#startDate").val( obj.startTime.toString("MM/dd/yyyy") ).end()
		.find("#endDate").val( obj.endTime.toString("MM/dd/yyyy")).end() 
        
        if (allday) 
        {
            newevt.find("#dfltPlgnallDayEvent").attr("checked", true);
            newevt.find("#startTime").val("").end().find("#endTimeTxt").val("");
        }
        else 
        {
            newevt.find("#dfltPlgnallDayEvent").attr("checked", false);
            newevt.find("#startTime").val( obj.startTime.toString("h:mm tt"));
            newevt.find("#endTime").val( obj.endTime.toString("h:mm tt") ); 
        }
         
        //display a list of groups to select from.
        newevt.find("#dfltPlgngroupSelectDD").empty();
        for(var g in groups)
        {
            if(!groups.hasOwnProperty(g))continue;
            var grp = groups[g];
            newevt.find("#dfltPlgngroupSelectDD").append('<option value="'+grp.groupId+'">'+grp.name+'</option> ')
        }
        if(obj.group && obj.group.groupId)
            newevt.find("#dfltPlgngroupSelectDD").val(obj.group.groupId);

    }
	/**
	 * Updates event in DB. 
	 * After updating call ical.updateEvent to reflect the updated info in calendar
	 * @param {Object} event
	 */
    function updateEvent(event)
    {
		   ical.updateEvent(event);
    }
    

    function createDateTime(ti, h, numofDays)
    {
        var dd = new Date();
        dd.setHours(ti);
        dd.setMinutes(h);

        if (numofDays)
        {
            dd.addDays(numofDays);
        }
        return dd;
    }
    /**
     * Utility function to create one event.
     * 
     * @param {Object} name
     * @param {Object} id
     * @param {Object} location
     * @param {Object} instructor
     * @param {Object} timestart
     * @param {Object} timeend
     * @param {Object} desc
     * @param {Object} allDay
     * @param {Object} publishStatus
     * @param {Object} capacity
     * @param {Object} eventType
     * @param {Object} leadDays
     * @param {Object} trainersArr
     * @param {Object} registeredMembersArr
     * @param {Object} repeatObject
     */      				
	function createHealthClubEvent(name, id, location, instructor, timestart, timeend, desc, allDay, 
							 publishStatus, capacity,eventType, leadDays, trainersArr, registeredMembersArr,repeatObject)
	{
	
	    if (allDay == undefined) 
	        allDay = false;
	    
	    return {
	        name: name,
	        eventId: id,
	        facility: location,
	        instructor: instructor,
	        startTime: timestart ,
	        endTime: timeend ,
	        eventDesc: desc,
	        allDay: allDay,
			
			publishStatus: publishStatus,
			capacity: capacity,
			eventType: eventType,
			leadDays: leadDays,
			trainers: trainersArr,
			registeredMembers: registeredMembersArr,		
			
	        repeatEvent: repeatObject
	    };
		 
	}
  	/**
  	 * Function to return data for the calendar. 
  	 * @param {Object} startTime
  	 * @param {Object} endTime
  	 */
    function loadCalendarEvents(startTime, endTime)
    {
		
		var d = new Array();
	    var events = new Array(); 
	    events.push(createHealthClubEvent("Yoga Training", 1, "yoga aud", "John Smith", createDateTime(23, 0,-1), createDateTime(23, 30,1), "Yoga is good for health", true, 
		  "PENDING", 20, "PT", "2", [], [] ));
	    events.push(createHealthClubEvent("Spanning Many days", 2, "yoga aud", "John Smith", createDateTime(23, 0, -13), createDateTime(23, 30, -8), "Yoga is good for health", true,   "PENDING", 20, "PT", "2", [], []));
	    events.push(createHealthClubEvent("Spanning Many days", 3, "yoga aud", "John Smith", createDateTime(23, 0, -4), createDateTime(23, 30, 0), "Yoga is good for health", true,   "PENDING", 20, "PT", "2", [], []));	 
	    events.push(createHealthClubEvent("Spanning Many days", 5, "yoga aud", "John Smith", createDateTime(23, 0, -4), createDateTime(23, 30, 1), "Yoga is good for health", true,   "PENDING", 20, "PT", "2", [], []));	 
	    events.push(createHealthClubEvent("Just another Event", 6, "yoga aud", "John Smith", createDateTime(23, 0, -18), createDateTime(23, 30, -18), "Yoga is good for health", true,   "PENDING", 20, "PT", "2", [], []));
		 	 
	    events.push(createHealthClubEvent("Event 100", 7, "yoga aud", "John Smith", createDateTime(3, 0, -1), createDateTime(7, 30, -1), "Yoga is good for health", false,   "PENDING", 20, "PT", "2", [], []));	 
	    events.push(createHealthClubEvent("Event 200",8, "yoga aud", "John Smith", createDateTime(5, 0, 1), createDateTime(8, 30, 1), "Yoga is good for health", false,   "PENDING", 20, "PT", "2", [], []));	 
	    events.push(createHealthClubEvent("Event 300", 9, "yoga aud", "John Smith", createDateTime(9, 0, 2), createDateTime(12, 30, 2), "Yoga is good for health", false,   "PENDING", 20, "PT", "2", [], []));
	     
	    var group = {
	        name: "Gym 1",
	        groupId: "100",
	        events: events
	    };
	    d.push(group);
	    
	    var events = new Array();
	    events.push(createHealthClubEvent("Morning Yoga", 10, "Yoga Auditorium", "Instructor1", createDateTime(15, 0, 1), createDateTime(19, 30, 1), "Morning Yoga is good for health", false,   "PENDING", 20, "PT", "2", [], []));	 
	    events.push(createHealthClubEvent("Event 2", 11, "Event Location 2", "Instructor2", createDateTime(8, 0, -1), createDateTime(10, 30, -1), "Event Description ...", false,   "PENDING", 20, "PT", "2", [], []));	 
	    events.push(createHealthClubEvent("Event 3", 12, "Event Location 3", "Instructor3", createDateTime(11, 0), createDateTime(12, 0), "Event Description ...", false,   "PENDING", 20, "PT", "2", [], []));	 
	    events.push(createHealthClubEvent("Event 4", 13, "Event Location 4", "Instructor4", createDateTime(6, 0), createDateTime(10, 0), "Event Description ...", false,   "PENDING", 20, "PT", "2", [], []));	 
	    events.push(createHealthClubEvent("Event 5", 14, "Event Location 5", "Instructor5", createDateTime(7, 0), createDateTime(10, 0), "Event Description ...", false,   "PENDING", 20, "PT", "2", [], []));	 
	    events.push(createHealthClubEvent("Event 6", 15, "Event Location 6", "Instructor6", createDateTime(16, 0, -2), createDateTime(20, 0,-2), "Event Description ...", false,   "PENDING", 20, "PT", "2", [], []));	 
	 	events.push(createHealthClubEvent("Event 7", 16, "Event Location 7", "Instructor7", createDateTime(10, 0, -3), createDateTime(15, 0,-3), "Event Description ...", false,   "PENDING", 20, "PT", "2", [], []));	 
	    events.push(createHealthClubEvent("Event 8", 17, "Event Location 8", "Instructor8", createDateTime(9, 0, -5), createDateTime(11, 15,-5), "Event Description ...", false,   "PENDING", 20, "PT", "2", [], []));	 
	 	events.push(createHealthClubEvent("Event 9", 18, "Event Location 9", "Instructor9", createDateTime(9, 0, 1), createDateTime(11, 15,1), "Event Description ...", false,   "PENDING", 20, "PT", "2", [], []));	 
	 	  var group = {
	        name: "Gym 2",
	        groupId: "200",
	        events: events
	    };
	    d.push(group);
	    
	    events = new Array();
	    events.push(createHealthClubEvent("Aqua Lessons", 3104, "Swim Pool 1", "Rob", createDateTime(11, 0, -2), createDateTime(15, 30, -2), "Spinning is good for health"));
	     
        ical.render(d);
    }
    
   
    /**
     Provide implementation for these methods.
     */
    /**
     Click on Edit Button
     */
    function rzEditEvent()
    {
        alert("editing");
    }
    
    /**
     Clicking delete in Preview box
     */
    function rzDeleteEvent()
    {
        alert("Delete Event in DB and invoke ical.deleteEvent({eventId: id})");
    }
    
	/**
	 * Local list of products, these are loaded into the products drop down.
	 * 
	 */
	var productsArr={
		"obj1":{desc: "Relaxing massage class with our well trained masseuse", leadDays: "0 Days", minAge:14, memRequired:"Yes", capacity:1, waitSize:"N/A"}			
		,"obj2":{desc: "Aqua workout", leadDays: "1 Days", minAge:18, memRequired:"Yes", capacity:14, waitSize:"10"}			
		,"obj3":{desc: "Cardio Cross Training", leadDays: "1 Days", minAge:18, memRequired:"Yes", capacity:14, waitSize:"10"}			
	};
	/**
	 * Function displays information for the selected product
	 * @param {Object} obj - select box
	 */
	function loadOtherDetails(obj)
	{
		var svalue = obj.value;
		var x = productsArr[svalue];
		if (svalue == "") 
		{
			x = {
				desc: "",
				leadDays: "",
				minAge: "",
				memRequired: "",
				capacity: "",
				waitSize: ""
			};
			jQuery("#productInfo").hide();
		}
		else{
			
			jQuery("#productInfo").show();
		} 
		if (x) 
		{
			var newevt = jQuery("#gmCalendarNewEvent"); 
			
			// blank out the other values
			newevt.find("#newMembershipRequiredSpan").html(x.memRequired);
			newevt.find("#newMembershipRequiredImg").attr("src", "images/empty.gif");
			newevt.find("#newAgeLimitSpan").html(x.minAge);
			
			newevt.find("#newEventDescDiv").html(x.desc);
			newevt.find("#newCapacity").val(x.capacity);
			newevt.find("#newLeadDaysToCancelSpan").html(x.leadDays);
			
			newevt.find("#newWaitSizeLimit").html(x.waitSize);
		}
	}
    
	WEB2CAL_LICENSE_KEY=["*****EMBED YOUR LICENSE KEY HERE****" ];
    
	/**
	 * Create the calendar when document is loaded.
	 */
    jQuery(document).ready(function()
    {		
        createCalendar();
		setupNewEvt(jQuery("#calendarNewEvent"));
		
    });
	
</script>

		
	</body>
</html>
